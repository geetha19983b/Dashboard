@model IEnumerable<DashBoard.Models.ProgramCSLVM>

@{
    ViewBag.Title = "Home Page";
}

<link href="~/Content/bootstrap-tagsinput.css" rel="stylesheet" />
<script src="~/js/morris-data.js" type="text/javascript"></script>

<script type="text/javascript">

    //angular.element(document).ready(function () {
    //    angular.bootstrap($("#appElement"), ['CommentsApp']); // appElement is the html element on which you define ng-app, myApp is the name of the app
    //});

    function Redirect(type) {
        var towers;
        towers.value = $("input[id=towerSel]").val();
        var periods;
        periods.value = $("input[id=periodSel]").val();
    };


    $(function () {
        $('[rel="popover"]').popover({
            container: 'body',
            html: true,
            content: function () {
                var clone = $($(this).data('popover-content')).clone(true).removeClass('hide');
                return clone;
            }
        }).click(function (e) {
            e.preventDefault();
        });
    });


    $(document).ready(function () {

        document.getElementById("Search").style.display = 'none';
        document.getElementById("DivContent").style.display = 'none';
        document.getElementById("Charts").style.display = 'block';
        document.getElementById("switch").style.display = 'none';

        $("#checkAllPriorities").change(function () {
            $("input[name='Priorities']").prop('checked', $(this).prop("checked"));
        });
        $("#checkAllTowers").change(function () {
            $("input[name='Towers']").prop('checked', $(this).prop("checked"));
        });
        $("#checkAllMetal").change(function () {
            $("input[name='MetalSelection']").prop('checked', $(this).prop("checked"));
        });


        $("#switch").click(function () {

            $("#DivContent").fadeOut("slow");
            $(this).hide();

        });


        $("span.list-group-item").on('click', function () {

            var Tower = $(this).find(".title").html();
            //alert("Tower" + Tower);

            var Parent = $(this).parent().parent().parent().find(".panel-title").find(".title").html();
            //alert("Parent" + Parent);

            var url = $('#summaryDialog1').data('url') + '?catgry=' + Parent + '&tower=' + Tower;
            $.get(url, function (data) {
                $('#summaryDialog1').html(data);
                $('#summaryDialog1').modal('show');
            });
        });

    });

    function rmveCheckAll() {
        if ($("#checkAllTowers").checked) {
            $("#checkAllTowers").prop('checked', false);
        }
        if ($("#checkAllPriorities").checked) {
            $("#checkAllPriorities").prop('checked', false);
        }
        if ($("#checkAllMetal").checked) {
            $("#checkAllMetal").prop('checked', false);
        }
    }

    function ChartsView() {
        document.getElementById("DivContent").style.display = 'none';
        document.getElementById("Charts").style.display = 'block';
        document.getElementById("switch").style.display = 'none';
        document.getElementById("Search").style.display = 'none';
    };

</script>



@Html.Hidden("chartsData", (string)ViewBag.chartsData)
@Html.Hidden("towerSel", (object)ViewBag.towerSel)
@Html.Hidden("periodSel", (object)ViewBag.periodSel)


@*<br />

    @using (Html.BeginForm("ConvertThisPageToPdfTest2", "Home", FormMethod.Post, new { id = "convertForm" }))
    {
        <div id="convertThisPageButtonDiv">
            <input type="submit" value="Export this page to PDF" />
        </div>
    }

    <br />*@


<div id="page-wrapper" style="margin-left: auto">
    <div class="row">
        <div class="col-xs-12 col-md-12">
            <div class="modal fade" id="summaryDialog1" tabindex="-1" role="dialog" aria-labelledby="myModal-label"
                 aria-hidden="true" data-url='@Url.Action("SummaryDetails", "SAS")'></div>
        </div>
    </div>
    <div class="row">
        <!-- Modal -->
        <div class="modal fade" style="top: 40px;" id="filter_options" tabindex="-1" role="dialog" aria-labelledby="filter_optionsLabel" aria-hidden="true">
            <div class="modal-dialog" style="width:70%">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h3 class="modal-title" id="filter_optionsLabel" style="font-family: verdana,arial,sans-serif; font-size: 11px;">Customize Options</h3>
                    </div>
                    <div class="modal-body">
                        <div class="row">

                            <!-- Multiple Checkboxes -->
                            <div class="col-md-3" style="font-family: verdana,arial,sans-serif; font-size: 11px; color: #333333;">
                                <label for="Towers">Towers</label>
                                <div>
                                    <div class="checkbox">
                                        <label for="Priorities-A">
                                            <input id="checkAllTowers" name="TowerAll" type="checkbox" value="All" />
                                            Check All
                                        </label>
                                    </div>
                                    @{int twrcunt = 0;}
                                    @foreach (var item in ViewBag.towerSel)
                                    {
                                        <div class="checkbox">
                                        <label for="Towers-" @twrcunt>
                                            <input name="Towers" id="Towers-"@twrcunt type="checkbox" class="chkbox" value=@item.TowerValue />
                                            @item.Tower
                                        </label>
                                    </div>
                                        twrcunt ++;
                                    }

                            </div>
                        </div>


                            <!-- Multiple Checkboxes -->
                                        <div class="col-md-3" style="font-family: verdana,arial,sans-serif; font-size: 11px; color: #333333;">
                                            <label for="Priorities">Priorities</label>
                                            <div>
                                                <div class="checkbox">
                                                    <label for="Priorities-A">
                                                        <input id="checkAllPriorities" name="PrioritiesAll" type="checkbox" value="All" />
                                                        Check All
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="Priorities-0">
                                                        <input name="Priorities" id="Priorities-0" type="checkbox" class="chkbox" value="1 - Critical" />
                                                        1 - Critical
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="Priorities-1">
                                                        <input name="Priorities" id="Priorities-1" type="checkbox" class="chkbox" value="2 - High" />
                                                        2 - High
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="Priorities-2">
                                                        <input name="Priorities" id="Priorities-2" type="checkbox" class="chkbox" value="3 - Moderate" />
                                                        3 - Moderate
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="Priorities-3">
                                                        <input name="Priorities" id="Priorities-3" type="checkbox" class="chkbox" value="4 - Low" />
                                                        4 - Low
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                            <!-- Multiple Checkboxes -->
                                        <div class="col-md-3" style="font-family: verdana,arial,sans-serif; font-size: 11px; color: #333333;">
                                            <label for="MetalSelection">Metal</label>
                                            <div>
                                                <div class="checkbox">
                                                    <label for="Metal-A">
                                                        <input id="checkAllMetal" name="MetalsAll" type="checkbox" value="All" />
                                                        Check All
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="MetalSelection-0">
                                                        <input name="MetalSelection" id="MetalSelection-0" type="checkbox" class="chkbox" value="Gold" />
                                                        Gold
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="MetalSelection-1">
                                                        <input name="MetalSelection" id="MetalSelection-1" type="checkbox" class="chkbox" value="Silver" />
                                                        Silver
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="MetalSelection-2">
                                                        <input name="MetalSelection" id="MetalSelection-2" type="checkbox" class="chkbox" value="Bronze" />
                                                        Bronze
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-3" style="font-family: verdana,arial,sans-serif; font-size: 11px; color: #333333;">
                                            <label for="TierSelection">Tier</label>
                                            <div>
                                                <div class="checkbox">
                                                    <label for="Tier-A">
                                                        <input id="checkAllTier" name="TiersAll" type="checkbox" value="All" />
                                                        Check All
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="TierSelection-1">
                                                        <input name="TierSelection" id="TierSelection-1" type="checkbox" class="chkbox" value="Tier-1" />
                                                        Tier-1
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="TierSelection-2">
                                                        <input name="TierSelection" id="TierSelection-2" type="checkbox" class="chkbox" value="Tier-1" />
                                                        Tier-2
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="TierSelection-3">
                                                        <input name="TierSelection" id="TierSelection-3" type="checkbox" class="chkbox" value="Tier-3" />
                                                        Tier-3
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label for="TierSelection-4">
                                                        <input name="TierSelection" id="TierSelection-3" type="checkbox" class="chkbox" value="Tier-4" />
                                                        Tier-4
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                        <div class="row">
                                            <div class="col-md-8" style="font-family: verdana,arial,sans-serif; font-size: 11px; color: #333333;">

                                                <div>
                                                    <label for="selectPeriod">Period</label>
                                                    <select name="selectPeriod" id="selectPeriod">
                                                        <option value="3">Last 3 months</option>
                                                        <option value="6" selected="selected">Last 6 months</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-sm btn-success" id="mapply" onclick='renderDashboardCharts();' data-dismiss="modal">Apply</button>
                                            <button type="button" class="btn btn-sm btn-warning" onclick='' data-dismiss="modal">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                                        <div class="row">
                                            <div class="col-xs-12 col-md-12">

                                                <div class="modal fade" id="bootstrapDialog" tabindex="-1" role="dialog" aria-labelledby="myModal-label"
                                                     aria-hidden="true" data-url='@Url.Action("BarChartInfer", "Home")'></div>

                                                <img id="Image1" class="pull-left" data-toggle="modal" data-target="#filter_options" style="font-family:Calibri" src="~/Images/Customize.png" width="30" height="30" />
                                                <div id="sel_filter_options" class="bootstrap-tagsinput" style="border:0px"></div>

                                            </div>
                                        </div>
    <!-- /.row -->

                                        <div class="row">
                                            <br />
                                            <div class="col-lg-3 col-md-6">
                                                <div class="panel panel-primary">
                                                    <div class="panel-heading">
                                                        <div class="row">
                                                            <div class="col-xs-3" style="width: 130px;height:45px;">
                                                                <h4 style="font-family: Calibri; font-size: medium;color:white;">Total Incidents</h4>
                                                                <h6 style="font-family: Calibri; font-size:small; color: white;"> @Html.Label(DateTime.Now.AddMonths(-1).ToString("MMMMMMMMMM") + " " + " Inflow")</h6>
                                                            </div>
                                                            <div class="pull-right" style="width:50px;padding-right:10px;">
                                                                <div id="TotalIncCnt" class="h4" style="font-family: Calibri; font-size: medium;color:white;"></div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="panel-footer" onclick='LoadIncidentTable("Total","blue");'>
                                                        <span class="pull-left" style="color: #2980B9;">View Incidents</span>
                                                        <span class="pull-right" style="color: #2980B9;"><i class="fa fa-arrow-circle-right"></i></span>
                                                        <div class="clearfix"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-3 col-md-6">
                                                <div class="panel panel-green">
                                                    <div class="panel-heading">
                                                        <div class="row">
                                                            <div class="col-xs-3" style="width: 160px;height:45px;">
                                                                <h4 style="font-family: Calibri; font-size: medium;color:white;">Resolved Incidents</h4>
                                                                <h6 style="font-family: Calibri; font-size:small; color: white;"> @Html.Label("As of" + " " + DateTime.Now.AddMonths(-1).ToString("MMMMMMMMMM"))</h6>
                                                            </div>
                                                            <div class="pull-right" style="width:40px;padding-right:10px;">
                                                                <div id="ResIncCnt" class="h4" style="font-family: Calibri; font-size: medium;color:white;"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="panel-footer" onclick='LoadIncidentTable("Resolved","green");'>
                                                        <span class="pull-left" style="color: green;">View Incidents</span>
                                                        <span class="pull-right" style="color: green;"><i class="fa fa-arrow-circle-right"></i></span>
                                                        <div class="clearfix"></div>
                                                    </div>

                                                </div>
                                            </div>
                                            <div class="col-lg-3 col-md-6">
                                                <div class="panel panel-yellow">
                                                    <div class="panel-heading">
                                                        <div class="row">
                                                            <div class="col-xs-3" style="width: 160px;height:45px;">
                                                                <h4 style="font-family: Calibri; font-size: medium;color:white;">Backlog Incidents</h4>
                                                                <h6 style="font-family: Calibri; font-size:small; color: white;"> @Html.Label("As of" + " " + DateTime.Now.AddMonths(-1).ToString("MMMMMMMMMM"))</h6>
                                                            </div>
                                                            <div class="pull-right" style="width:30px;padding-right:10px;">
                                                                <div id="PendIncCnt" class="h4" style="font-family: Calibri; font-size: medium;color:white;"></div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="panel-footer" onclick='LoadIncidentTable("Pending","orange");'>
                                                        <span class="pull-left" style="color: orange;">View Incidents</span>
                                                        <span class="pull-right" style="color: orange;"><i class="fa fa-arrow-circle-right"></i></span>
                                                        <div class="clearfix"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-3 col-md-6">
                                                <div class="panel panel-red">
                                                    <div class="panel-heading">
                                                        <div class="row">
                                                            <div class="col-xs-3" style="width: 200px;height:45px;">
                                                                <h4 style="font-family: Calibri; font-size: medium;color:white;">Resolution SLA Breached</h4>
                                                                <h6 style="font-family: Calibri; font-size:small; color: white;"> @Html.Label("As of" + " " + DateTime.Now.AddMonths(-1).ToString("MMMMMMMMMM"))</h6>
                                                            </div>
                                                            <div class="pull-right" style="width:30px;padding-right:10px;">
                                                                <div id="BrcIncCnt" class="h4" style="font-family: Calibri; font-size: medium;color:white;"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="panel-footer" onclick='LoadIncidentTable("Breached","red");'>
                                                        <span class="pull-left" style="color: red;">View Incidents</span>
                                                        <span class="pull-right" style="color: red;"><i class="fa fa-arrow-circle-right"></i></span>
                                                        <div class="clearfix"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        @*<button id="switch" style="background-color:lightgray" onclick="'ChartsView();'">Switch to Trends View</button>*@
                                        <button id="switch" class="btn btn-primary" onclick="'ChartsView();'">Hide Table</button>



                                        <div class="row" id="DivContent" style="display:none">

                                            @*@Html.Partial("SearchFilters")*@

                                            @{Html.RenderAction("IncidentPartialSrch", "Home");}

                                            @*<div class="col-md-12">
                                                    <div class="panel panel-default">
                                                        <div class="panel-body" style="width: 100%">
                                                            <div id="StudentTableContainer3">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>*@

                                        </div>
    <!-- /.row -->


                                        <div class="row" id="Charts">

                                            <div class="col-md-8 col-xs-8" style="width: 50%;">
                                                <div class="panel panel-primary">
                                                    <div class="panel-heading">
                                                        <i class="fa fa-bar-chart-o fa-fw"></i>Aging Incidents
                                                    </div>
                                                    <!-- /.panel-heading -->
                                                    <div class="panel-body">
                                                        <div id="aging_inc" style="height: 180px"></div>
                                                    </div>
                                                    <!-- /.panel-body -->
                                                </div>
                                            </div>

                                            <div class="col-md-8 col-xs-8" style="width: 50%;">
                                                <div class="panel panel-primary">
                                                    <div class="panel-heading">
                                                        <i class="fa fa-bar-chart-o fa-fw"></i>Pending Incidents
                                                    </div>
                                                    <!-- /.panel-heading -->
                                                    <div class="panel-body">
                                                        <div id="backlog_inc" style="height: 180px"></div>
                                                    </div>
                                                    <!-- /.panel-body -->
                                                </div>
                                            </div>


                                            <div class="col-md-8 col-xs-8">
                                                <div class="panel panel-primary">
                                                    <div class="panel-heading" style="font-family: Calibri; font-size: medium;">
                                                        <i class="fa fa-bar-chart-o fa-fw"></i>Incident Summary by Towers
                                                    </div>
                                                    <!-- /.panel-heading -->
                                                    <div class="panel-body">
                                                        <div id="inflow-chart" style="height: 250px"></div>
                                                    </div>
                                                    <!-- /.panel-body -->
                                                </div>
                                                <!-- /.panel -->
                                                <div class="panel panel-primary">
                                                    <div class="panel-heading" style="font-family: Calibri; font-size: medium;">
                                                        <i class="fa fa-bar-chart-o fa-fw"></i>Resolution Rate (%)
                                                    </div>
                                                    <!-- /.panel-heading -->
                                                    <div class="panel-body">
                                                        <div id="resolution-rate" style="height: 230px"></div>
                                                    </div>
                                                    <!-- /.panel-body -->
                                                </div>
                                                <!-- /.panel -->
                                                <!-- /.panel -->
                                                <div class="panel panel-primary">
                                                    <div class="panel-heading" style="font-family: Calibri; font-size: medium;">
                                                        <i class="fa fa-bar-chart-o fa-fw"></i>Resolution SLA (%)
                                                    </div>
                                                    <!-- /.panel-heading -->
                                                    <div class="panel-body">
                                                        <div id="resolution-sla" style="height: 230px"></div>
                                                    </div>
                                                    <!-- /.panel-body -->
                                                </div>
                                                <!-- /.panel -->
                                                <!-- /.panel -->
                                                <div class="panel panel-primary">
                                                    <div class="panel-heading" style="font-family: Calibri; font-size: medium;">
                                                        <i class="fa fa-bar-chart-o fa-fw"></i>Response SLA (%)
                                                    </div>
                                                    <!-- /.panel-heading -->
                                                    <div class="panel-body">
                                                        <div id="response-sla" style="height: 230px"></div>
                                                    </div>
                                                    <!-- /.panel-body -->
                                                </div>
                                                <!-- /.panel -->

                                            </div>
                                            <!-- /.col-lg-8 -->


                                            <div class="col-md-4 col-xs-4">
                                                <div class="row">
                                                    <div class="col-lg-12">
                                                        <div class="panel panel-primary">
                                                            <div class="panel-heading" style="font-family: Calibri; font-size: medium;">
                                                                <i class="fa fa-bell fa-fw"></i>Program Level CSL Summary
                                                            </div>
                                                            <!-- /.panel-heading -->
                                                            <div class="panel-group" id="accordion">
                                                                @{int i = 0;}
                                                                @foreach (var item in Model)
                                                                {

                                                                    <div class="panel panel-info">
                                                                        <div class="panel-heading">
                                                                            <h3 class="panel-title" data-toggle="collapse" data-target=#@i style="font-family: Calibri; font-size: medium;color:#4D5656;">
                                                                                <i class="fa fa-check fa-fw"></i>  <i class="title">  @Html.DisplayFor(modelItem => item.Category)</i>
                                                                                <span class="pull-right text-muted medium">
                                                                                    <em>
                                                                                        @Html.DisplayFor(modelItem => item.Categoryavg)
                                                                                    </em>
                                                                                </span>
                                                                            </h3>
                                                                        </div>
                                                                        <div id=@i class="panel-collapse collapse">
                                                                            <div class="panel-body">

                                                                                @foreach (var ctglist in item.TowerList)
                                                                                {

                                                                                    <span class="list-group-item" style="cursor:pointer">
                                                                                        <i class="fa fa-user fa-fw"></i>@*@Html.DisplayFor(modelItem => ctglist.Tower)*@
                                                                                        <i class="title">
                                                                                            @ctglist.Tower
                                                                                        </i>
                                                                                        <span class="pull-right text-muted medium">
                                                                                            <em>
                                                                                                @*@Html.DisplayFor(modelItem => ctglist.Value)*@
                                                                                                @ctglist.Value
                                                                                            </em>
                                                                                        </span>
                                                                                    </span>


                                                                                }

                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                                i++;
                                                                }
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 col-xs-12">
                                                        <div class="panel panel-primary">
                                                            <div class="panel-heading" style="font-family: Calibri; font-size: medium;">
                                                                <i class="fa fa-bar-chart-o fa-fw"></i>Backlog Trend
                                                            </div>
                                                            <div class="panel-body">
                                                                <div id="backlog-chart" style="height: 300px;"></div>
                                                            </div>
                                                            <!-- /.panel-body -->
                                                        </div>
                                                        <!-- /.panel -->

                                                    </div>


                                                </div>

                                                <div class="panel panel-primary">
                                                    <div class="panel-heading" style="font-family: Calibri; font-size: medium;">
                                                        <i class="fa fa-bar-chart-o fa-fw"></i>P1/P2 Occurrence Trend
                                                    </div>
                                                    <div class="panel-body">
                                                        <div id="priority-chart" style="height: 300px"></div>
                                                    </div>
                                                    <!-- /.panel-body -->
                                                </div>
                                                <!-- /.panel -->

                                            </div>
                                            <!-- /.col-lg-4 -->
                                        </div>
    <!-- /.row -->



                                    </div>

                                    <script type="text/javascript">
                                        $(document).ready(function () {
                                            //Prepare jtable plugin
                                            JtableInit();



                                        });
                                        function jtablecolorchange(color) {
                                            if (color == "red") {

                                                //$('#jstyle').attr('href', '~/Scripts/jtable.2.4.0/themes/metro/red/jtable.min.css');
                                                //alert($('#jstyle').attr('href').toString());

                                                $("div.jtable-main-container > div.jtable-title").css({ "background-color": "#d9534f" });
                                                $("div.jtable-main-container > table.jtable > thead").css({ "background-color": "#d9534f" });
                                                $("div.jtable-main-container > div.jtable-bottom-panel").css({ "background-color": "#d9534f" });

                                            }
                                            else if (color == "orange") {

                                                $("div.jtable-main-container > div.jtable-title").css({ "background-color": "#F0AD4E" });
                                                $("div.jtable-main-container > table.jtable > thead").css({ "background-color": "#F0AD4E" });
                                                $("div.jtable-main-container > div.jtable-bottom-panel").css({ "background-color": "#F0AD4E" });

                                            }
                                            else if (color == "green") {


                                                $("div.jtable-main-container > div.jtable-title").css({ "background-color": "#5cb85c" });
                                                $("div.jtable-main-container > table.jtable > thead").css({ "background-color": "#5cb85c" });
                                                $("div.jtable-main-container > div.jtable-bottom-panel").css({ "background-color": "#5cb85c" });

                                            }
                                            else {
                                                $("div.jtable-main-container > div.jtable-title").css({ "background-color": "#1c78de" });
                                                $("div.jtable-main-container > table.jtable > thead").css({ "background-color": "#1c78de" });
                                                $("div.jtable-main-container > div.jtable-bottom-panel").css({ "background-color": "#1c78de" });
                                            }

                                        }
                                        function LoadIncidentTable(type, color) {


                                            jtablecolorchange(color);


                                            var chgtype = type;
                                            $('#IncidentTableContainer').jtable('load', {
                                                cndn: chgtype
                                            });

                                            //document.getElementById("DivContent").style.display = 'block';
                                            $("#DivContent").fadeIn("slow");
                                            //document.getElementById("Charts").style.display = 'none';
                                            document.getElementById("switch").style.display = 'block';
                                            document.getElementById("Search").style.display = 'block';

                                        };
                                        function JtableInit() {
                                            $('#IncidentTableContainer').jtable({
                                                title: 'Incident List',
                                                paging: true,
                                                pageSize: 10,
                                                sorting: true,
                                                defaultSorting: 'ParentIncident ASC',
                                                actions: {
                                                    //listAction: '/Home/IncidentsByFilter?cndn=' + type,
                                                    listAction: '@Url.Action("IncidentsByFilter","Home")?ITaskId=' + 'Bala',
                                                    updateAction: '@Url.Action("UpdateIncident", "Home")'
                                                },
                                                fields: {
                                                    //CHILD TABLE DEFINITION FOR "EXAMS"
                                                    Exams: {
                                                        title: '',
                                                        width: '5%',
                                                        sorting: false,
                                                        edit: false,
                                                        create: false,
                                                        listClass: 'child-opener-image-column',
                                                        display: function (studentData) {
                                                            //Create an image that will be used to open child table
                                                            //var $img = $('<img class="child-opener-image" src="/Content/images/Misc/note.png" title="Edit exam results" />');
                                                            var $img = $('<img class="child-opener-image" src=@Url.Content("~/Content/images/Misc/note.png") title="Edit exam results" />');


                                                            //Open child table when user clicks the image
                                                            $img.click(function () {


                                                                $('#IncidentTableContainer').jtable('openChildTable',
                                                                    $img.closest('tr'), //Parent row
                                                                    {
                                                                        title: studentData.record.ParentIncident + ' - ITask Details',
                                                                        actions: {
                                                                            //var url = '@Url.Action("ViewFile", "Default")?itemId=' + $(this).data("itemid")
                                                                            //listAction: '/Home/TaskList?ITaskId=' + studentData.record.ParentIncident,
                                                                            listAction: '@Url.Action("TaskList", "Home")?ITaskId=' + studentData.record.ParentIncident,
                                                                            //updateAction: '/Home/UpdateTask'
                                                                            updateAction: '@Url.Action("UpdateTask","Home")'
                                                                        },
                                                                        fields: {
                                                                            Number: {
                                                                                title: 'Number',
                                                                                width: '10%'
                                                                            },
                                                                            Priority: {
                                                                                title: 'Priority',
                                                                                width: '10%',
                                                                                edit: false
                                                                            },
                                                                            ServiceOffering: {
                                                                                title: 'SO',
                                                                                width: '10%',
                                                                                edit: false
                                                                            },
                                                                            AssignedTo: {
                                                                                title: 'AssignedTo',
                                                                                width: '10%',
                                                                                edit: false
                                                                            },
                                                                            ItState: {
                                                                                title: 'State',
                                                                                width: '10%',
                                                                                edit: false
                                                                            },
                                                                            Metal: {
                                                                                title: 'Metal',
                                                                                width: '10%',
                                                                                edit: false
                                                                            },
                                                                            ResponseSLA: {
                                                                                title: 'ResponseSLA',
                                                                                width: '10%',
                                                                                edit: false,
                                                                                list: false
                                                                            },
                                                                            ResolutionSLA: {
                                                                                title: 'ResolutionSLA',
                                                                                width: '10%',
                                                                                edit: false,
                                                                                list: false
                                                                            },
                                                                            Comments: {
                                                                                title: 'Comments',
                                                                                width: '10%',
                                                                                type: 'textarea'
                                                                            }
                                                                        }
                                                                    }, function (data) { //opened handler
                                                                        data.childTable.jtable('load');
                                                                    });


                                                            });
                                                            //Return image to show on the person row
                                                            return $img;
                                                        }
                                                    },
                                                    //FeedID: {
                                                    //    key: true,
                                                    //    create: false,
                                                    //    edit: false,
                                                    //    list: false
                                                    //},
                                                    ParentIncident: {
                                                        title: 'Incident',
                                                        width: '10%'
                                                    },
                                                    IncidentPriority: {
                                                        title: 'Priority',
                                                        width: '10%',
                                                        edit: false
                                                    },
                                                    IncServiceOffering: {
                                                        title: 'SO',
                                                        width: '10%',
                                                        edit: false
                                                    },
                                                    IncAssignmentGroup: {
                                                        title: 'Assignment Group',
                                                        width: '10%',
                                                        edit: false
                                                    },
                                                    //Opened: {
                                                    //    title: 'Opened date',
                                                    //    width: '15%',
                                                    //    type: 'date',
                                                    //    displayFormat: 'dd/mm/yy',
                                                    //    create: false,
                                                    //    edit: false,
                                                    //    sorting: false //This column is not sortable!
                                                    //},
                                                    State: {
                                                        title: 'State',
                                                        width: '10%',
                                                        edit: false
                                                    },
                                                    ResponseSLA: {
                                                        title: 'ResponseSLA',
                                                        width: '10%',
                                                        list: false,
                                                        edit: false

                                                    },
                                                    ResolutionSLA: {
                                                        title: 'ResolutionSLA',
                                                        width: '10%',
                                                        list: false,
                                                        edit: false
                                                    },
                                                    TimeRemaining: {
                                                        title: 'TimeRemaining',
                                                        width: '10%',
                                                        list: false,
                                                        edit: false
                                                    },
                                                    Tower: {
                                                        title: 'Tower',
                                                        width: '10%',
                                                        edit: false
                                                    },
                                                    AssignedTo: {
                                                        title: 'AssignedTo',
                                                        width: '10%',
                                                        edit: false
                                                    },
                                                    Metal: {
                                                        title: 'Metal',
                                                        width: '10%',
                                                        edit: false
                                                    },
                                                    Comments: {
                                                        title: 'Comments',
                                                        type: 'textarea'
                                                    }
                                                }
                                            });

                                            $('#SearchIncid').click(function (e) {
                                                e.preventDefault();
                                                $('#IncidentTableContainer').jtable('load', {
                                                    IncId: $('#IncidentNo').val()
                                                    //cityId: $('#<% = ddlCities1.ClientID %>').val()
                                                });
                                            });
                                        }

                                    </script>